# Poetry
curl -sSL https://install.python-poetry.org | python3 -
poetry init
poetry add --dev pytest pytest-cov black isort flake8 bandit
poetry add fastapi uvicorn httpx

# Tests
poetry run pytest tests.py

# Run
poetry run uvicorn main:app --reload
-- http://127.0.0.1:8000/api/health-check/

# Code Quality
poetry run black .
poetry run isort . --profile black
poetry run flake8 .
# All
poetry run black . && poetry run isort . --profile black && poetry run flake8 .

# ASGI
poetry add Mangum

# Docker
docker-compose up

# Local DyDB
export AWS_ACCESS_KEY_ID=abc && export AWS_SECRET_ACCESS_KEY=abc && export AWS_DEFAULT_REGION=eu-west-1 && export TABLE_NAME="local-tasks-api-table" && export DYNAMODB_URL=http://localhost:9999
poetry run python create_dynamodb_locally.py

poetry run uvicorn main:app --reload

# Create a task
curl --location --request POST 'http://localhost:8000/api/create-task' \
--header 'Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb2duaXRvOnVzZXJuYW1lIjoiam9obkBkb2UuY29tIn0.6UvNP3lIrXAinXYqH4WzyNrYCxUFIRhAluWyAxcCoUc' \
--header 'Content-Type: application/json' \
--data-raw '{
    "title": "Jump"
}'

# List open tasks
curl --location --request GET 'http://localhost:8000/api/open-tasks' \
--header 'Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb2duaXRvOnVzZXJuYW1lIjoiam9obkBkb2UuY29tIn0.6UvNP3lIrXAinXYqH4WzyNrYCxUFIRhAluWyAxcCoUc'

# Frontend
npm create vite@4.2.0
cd tasks_ui
npm install
npm run dev

npm install --include=dev --save serverless-s3-sync